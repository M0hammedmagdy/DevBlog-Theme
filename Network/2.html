<!DOCTYPE html>
<html lang="en"> 
<head>
    <title>InfoSec Write-ups</title>
    
    <!-- Meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Blog Template">
    <meta name="author" content="Xiaoying Riley at 3rd Wave Media">    
    <link rel="shortcut icon" href="favicon.ico"> 
    
    <!-- FontAwesome JS-->
	<script defer src="../assets/fontawesome/js/all.min.js"></script>
    
    <!-- Plugin CSS -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/styles/monokai-sublime.min.css">
    
    <!-- Theme CSS -->  
    <link id="theme-style" rel="stylesheet" href="../assets/css/theme-7.css">
    

</head> 

<body>
    
    <header class="header text-center">	    
	    <h1 class="blog-name pt-lg-4 mb-0"><a href="../index.html">Infosec Blog</a></h1>
        
	    <nav class="navbar navbar-expand-lg navbar-dark" >
           
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navigation" aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
			</button>

			<div id="navigation" class="collapse navbar-collapse flex-column" >
				<div class="profile-section pt-3 pt-lg-0">
				    <img class="profile-image mb-3 rounded-circle mx-auto" src="../assets/images/profile1.jpg" alt="image" >			
					
					<div class="bio mb-3">Hi, my name is Mohammed Magdy. <br>I am a CyberSecurity researcher and CTF player.<br><a href="../about.html">Find out more about me</a></div><!--//bio-->
					<ul class="social-list list-inline py-3 mx-auto">
			            <li class="list-inline-item"><a href="https://twitter.com/0xmoka"><i class="fab fa-twitter fa-fw"></i></a></li>
			            <li class="list-inline-item"><a href="https://www.linkedin.com/in/0xmoka/"><i class="fab fa-linkedin-in fa-fw"></i></a></li>
			            <li class="list-inline-item"><a href="https://github.com/M0hammedmagdy"><i class="fab fa-github-alt fa-fw"></i></a></li>
			            <li class="list-inline-item"><a href="https://web.facebook.com/0xmagdy"><i class="fab fa-facebook-f"></i></a></li>
			        </ul><!--//social-list-->
			        <hr> 
				</div><!--//profile-section-->
				
				<ul class="navbar-nav flex-column text-left">
					<li class="nav-item">
					    <a class="nav-link" href="../index.html"><i class="fas fa-home fa-fw mr-2"></i>Blog Home <span class="sr-only">(current)</span></a>
					</li>
					
					<li class="nav-item">
					    <a class="nav-link" href="../about.html"><i class="fas fa-user fa-fw mr-2"></i>About Me</a>
					</li>
				</ul>
				
			</div>
		</nav>
    </header>
    
    <div class="main-wrapper">
	    
	    <article class="blog-post px-3 py-5 p-md-5">
		    <div class="container">
			    <header class="blog-post-header">
				    <h2 class="title mb-2"><a href="https://tryhackme.com/room/furthernmap">Nmap</a></h2>
			    </header>
			    </a>
		    <h4><strong>Task 1 - Deploy </strong></h4>
		    <p>Press "Start Machine" and press complete</p>
		    <h4><strong>Task 2 - Introduction  </strong></h4>
		    <p><strong> What networking constructs are used to direct traffic to the right application on a server?</strong></p>
		    <p>Ports</p>
		    <p><strong> How many of these are available on any network-enabled computer?</strong></p>
		    <p>65535</p>
		    <p><strong> [Research] How many of these are considered "well-known"? (These are the "standard" numbers mentioned in the task)</strong></p>
		    <p>1024</p>
		    <h4><strong>Task 3 - Nmap Switches </strong></h4>
		    <p><strong> What is the first switch listed in the help menu for a 'Syn Scan' (more on this later!)? (nmap -h)</strong></p>
		    <p>-sS</p>	
	            <img src="images/nmap/-sS.png" alt="image" >	
		    <p><strong> Which switch would you use for a "UDP scan"?</strong></p>
		    <p>-sU</p>	
	            <img src="images/nmap/-sU.png" alt="image" >
		    <p><strong> If you wanted to detect which operating system the target is running on, which switch would you use?</strong></p>
		    <p>-O</p>	
	            <img src="images/nmap/-O.png" alt="image" >		    
		    <p><strong> Nmap provides a switch to detect the version of the services running on the target. What is this switch?</strong></p>
		    <p>-sV</p>	
	            <img src="images/nmap/-sV.png" alt="image" >		    
		    <p><strong> The default output provided by nmap often does not provide enough information for a pentester. How would you increase the verbosity?</strong></p>
		    <p>-v</p>	
	            <img src="images/nmap/-v.png" alt="image" >
		    <p><strong> Verbosity level one is good, but verbosity level two is better! How would you set the verbosity level to two?</strong></p>
		    <p><strong> (Note: it's highly advisable to always use at least this option)</strong></p>
		    <p>-vv</p>	
		    <p><strong> We should always save the output of our scans -- this means that we only need to run the scan once (reducing network traffic and thus chance of detection), and gives us a reference to use when writing reports for clients.</strong></p>
		    <p><strong> What switch would you use to save the nmap results in three major formats?</strong></p>
		    <p>-oA</p>	
	            <img src="images/nmap/-oA.png" alt="image" >
		    <p><strong> What switch would you use to save the nmap results in a "normal" format?</strong></p>
		    <p>-oN</p>	
	            <img src="images/nmap/-oN.png" alt="image" >
		    <p><strong> A very useful output format: how would you save results in a "grepable" format?</strong></p>
		    <p>-oG</p>	
	            <img src="images/nmap/-oG.png" alt="image" >
		    <p><strong> Sometimes the results we're getting just aren't enough. If we don't care about how loud we are, we can enable "aggressive" mode. This is a shorthand switch that activates service detection, operating system detection, a traceroute and common script scanning.</strong></p>
		    <p><strong> How would you activate this setting?</strong></p>
		    <p>-A</p>	
	            <img src="images/nmap/-A.png" alt="image" >
		    <p><strong> Nmap offers five levels of "timing" template. These are essentially used to increase the speed your scan runs at. Be careful though: higher speeds are noisier, and can incur errors!</strong></p>
		    <p><strong> How would you set the timing template to level 5?</strong></p>
		    <p>-T5</p>	
	            <img src="images/nmap/-T5.png" alt="image" >
		    <p><strong> We can also choose which port(s) to scan.</strong></p>
		    <p><strong> How would you tell nmap to only scan port 80?</strong></p>
		    <p>-p 80</p>	
	            <img src="images/nmap/-p.png" alt="image" >
		    <p><strong>How would you tell nmap to scan ports 1000-1500?</strong></p>
		    <p>-p 1000-1500</p>	
		    <p><strong>A very useful option that should not be ignored:</strong></p>
		    <p><strong>How would you tell nmap to scan all ports?</strong></p>
		    <p>-p-</p>	
	            <img src="images/nmap/-p-.png" alt="image" >
		    <p><strong>How would you activate a script from the nmap scripting library (lots more on this later!)?</strong></p>
		    <p>--script</p>	
	            <img src="images/nmap/--script.png" alt="image" >
		    <p><strong>How would you activate all of the scripts in the "vuln" category?</strong></p>
		    <p>--script=vuln</p>	
		    <h4><strong>Task 4 - (Scan Types) Overview </strong></h4>
	            <p>Read and press complete</p>
		    <h4><strong>Task 5 - (Scan Types) TCP Connect Scans </strong></h4>
	            <p><strong> Which RFC defines the appropriate behaviour for the TCP protocol? </strong></p>
	            <p>RFC 793</p>
	            <p><strong>If a port is closed, which flag should the server send back to indicate this? </strong></p>
	            <p>RST</p>	
		    <h4><strong>Task 6 - (Scan Types) SYN Scans </strong></h4>
	            <p><strong> There are two other names for a SYN scan, what are they?</strong></p>
	            <p>Half-Open, Stealth</p>
	            <p><strong> Can Nmap use a SYN scan without Sudo permissions (Y/N)?</strong></p>
	            <p>N</p>
		    <h4><strong>Task 7 - (Scan Types) UDP Scans </strong></h4>
	            <p><strong>  If a UDP port doesn't respond to an Nmap scan, what will it be marked as? </strong></p>
                    <p>open|filtered</p>
	            <p><strong>When a UDP port is closed, by convention the target should send back a "port unreachable" message. Which protocol would it use to do so?</strong></p>
	            <p>ICMP</p>
	            <h4><strong>Task  8- (Scan Types) NULL, FIN and Xmas </strong></h4>
	            <p><strong>  Which of the three shown scan types uses the URG flag?</strong></p>
	            <p>xmas</p>
	            <p><strong> There are two other names for a SYN scan, what are they?</strong></p>
	            <p>Firewall Evasion</p>
	            <p><strong> Which common OS may respond to a NULL, FIN or Xmas scan with a RST for every port?</strong></p>
	            <p>Microsoft Windows</p>
		    <h4><strong>Task  9- (Scan Types) ICMP Network Scanning </strong></h4>
	            <p><strong>  How would you perform a ping sweep on the 172.16.x.x network (Netmask: 255.255.0.0) using Nmap? (CIDR notation)</strong></p>
	            <p>nmap -sn 172.16.0.0/16</p>
		    <h4><strong>Task  10- (NSE Scripts) Overview </strong></h4>
	            <p><strong> What language are NSE scripts written in?</strong></p>
	            <p>Lua</p>
	            <p><strong> Which category of scripts would be a very bad idea to run in a production environment?</strong></p>
	            <p>intrusive</p>
		    <h4><strong>Task  11- (NSE Scripts) Working with the NSE </strong></h4>
	            <p><strong> What optional argument can the ftp-anon.nse script take?</strong></p>
	            <p>maxlist</p>
		    <p>Read the <a target="_blank" rel="noopener" href="https://nmap.org/nsedoc/scripts/ftp-anon.html">ftp-anon doc</a>.</p>
		    <h4><strong>Task  12- (NSE Scripts) Searching for Scripts </strong></h4>
	            <p><strong> Search for "smb" scripts in the /usr/share/nmap/scripts/ directory using either of the demonstrated methods. What is the filename of the script which determines the underlying OS of the SMB server?</strong></p>
	            <p><strong> grep smb /usr/share/nmap/scripts/script.db | grep -e '-os'</strong></p>
	            <p>smb-os-discovery.nse</p>
	            <p><strong> Read through this script. What does it depend on?</strong></p>
	            <p><strong> rep dependencies /usr/share/nmap/scripts/smb-os-discovery.nse</strong></p>
	            <p>smb-brute</p>		    
		    <h4><strong>Task  13- Firewall Evasion </strong></h4>
	            <p><strong> Which simple (and frequently relied upon) protocol is often blocked, requiring the use of the -Pn switch?</strong></p>
	            <p>ICMP</p>
	            <p><strong> [Research] Which Nmap switch allows you to append an arbitrary length of random data to the end of packets?</strong></p>
	            <p>--data-length</p>
		    <h4><strong>Task  14- Practical </strong></h4>
	            <p><strong> Does the target (MACHINE_IP)respond to ICMP (ping) requests (Y/N)?</strong></p>
	            <p>N</p>
	            <p><strong> Perform an Xmas scan on the first 999 ports of the target -- how many ports are shown to be open or filtered?</strong></p>
	            <p>999</p>
	            <img src="images/nmap/nmap1.png" alt="image" >
	            <p><strong> There is a reason given for this -- what is it?</strong></p>
                    <p><strong> Note: The answer will be in your scan results. Think carefully about which switches to use -- and read the hint before asking for help!</strong></p>
	            <p>No Response</p>
	            <p><strong> Perform a TCP SYN scan on the first 5000 ports of the target -- how many ports are shown to be open?</strong></p>
	            <p>5</p>
	            <img src="images/nmap/nmap2.png" alt="image" >
	            <p><strong> Open Wireshark (see Cryillic's Wireshark Room for instructions) and perform a TCP Connect scan against port 80 on the target, monitoring the results. Make sure you understand what's going on.</strong></p>
	            <p>No answer needed</p>
	            <p><strong> Deploy the ftp-anon script against the box. Can Nmap login successfully to the FTP server on port 21? (Y/N)</strong></p>
	            <p>Y</p>
	            <img src="images/nmap/nmap3.png" alt="image" >
		    <h4><strong>Task  15- Conclusion  </strong></h4>
	            <p>Read and press complete</p>

			    <div class="blog-post-body">
				    
				    <section class="blog-list px-3 py-5 p-md-5">
		    <div class="container">
			    
			    
			    
				
		    </div>
	    </section>

</body>
</html> 
